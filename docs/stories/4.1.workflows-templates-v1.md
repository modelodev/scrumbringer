# Story 4.1: Plantillas de tarea v1 (para workflows)

## Status: Draft

## Story
**As an** org admin (and project admin),
**I want** to define task templates for workflow actions,
**so that** rules can create consistent follow-up tasks with variable substitution.

## Acceptance Criteria
1. **Template exists**: A `TaskTemplate` exists with fields: `task_type_id`, `title_template`, `description_template`, `capability_id?`.
2. **Variable substitution**: Templates support variables:
   - `{{father}}`, `{{from_state}}`, `{{to_state}}`, `{{project}}`, `{{user}}`.
3. **Scope**: Templates can be org-scoped or project-scoped.
4. **CRUD**: Admin can create/list/update/delete templates (soft delete ok).
5. **Safety**: Substitution is deterministic and does not allow arbitrary code execution.

## Tasks / Subtasks
- [ ] Define DB schema for templates
- [ ] Implement variable substitution function with tests
- [ ] Implement CRUD endpoints for templates
- [ ] Integrate templates with rules engine action execution

## Dev Notes
⚠️ **Planning stub / example**: This story is not fully refined.

- This expands the engine from “create a fixed task” to “create tasks from templates with variables”.

## Testing
- Server: `make test`
- Client: `apps/client: gleam test`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-14 | 0.1 | Planning stub created | po |

## Dev Agent Record

## QA Results
