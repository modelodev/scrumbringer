# Story 2.9: Rediseño Pool (más espacio + filtros en una fila + panel derecho persistente)

## Status: Ready

## Story
**As a** project member,
**I want** a pool UI layout that maximizes the workspace and keeps filters predictable,
**so that** I can review and operate on pending tasks faster and with less visual noise.

## Context
- This story is UI/UX driven and takes layout inspiration from legacy screenshots under `capturas/` (structure/interaction only; not the old visual theme).
- Theme controls are separate from layout: this story defines structure/behavior; colors and darkness are theme responsibility.

## Acceptance Criteria

1. **Pool workspace prioritized (desktop + tablet)**
   - The central Pool area is the primary workspace, with minimal chrome.
   - The right panel is always visible (see AC2).

2. **Right panel always visible**
   - A persistent right panel exists and contains:
     - Now Working (active task) with details + timer
     - A compact list of tasks claimed by the user
     - Quick actions relevant to Now Working / claimed tasks

3. **Filters are a single row when visible**
   - When filters are visible on desktop, all filter controls are presented in a single horizontal row.
   - Filters included: type, capability, “Mis capacidades”, and search `q`.
   - Pool scope guard: Pool continues to show only `available` tasks (no `claimed`/`completed` tasks displayed in Pool).

4. **Theme controls initial filter visibility (no surprises)**
   - The theme defines whether filters start `visible` or `hidden`.
   - Screen size must NOT auto-hide filters; it may only change presentation (see AC5).

5. **Responsive filter presentation: icon mode on narrower widths**
   - When filters are visible, narrower widths switch to an “icon mode” presentation:
     - Controls render as icons (or compact tokens) with accessible labels.
     - Labels/tooltips appear on both hover/click and keyboard focus.

6. **Keyboard shortcuts (desktop + tablet)**
   - Use `Ctrl` on Windows/Linux and `Cmd` on macOS.
   - `Ctrl/Cmd+Shift+F` toggles filters (show/hide).
   - `Ctrl/Cmd+K` focuses search `q`.
     - If filters are hidden, pressing `Ctrl/Cmd+K` first shows filters then focuses `q`.
   - `n` opens “create new task” flow.

   Shortcut scope rules:
   - Shortcuts are ignored when focus is inside an input/textarea/select, or when a modal/dialog is open.

7. **Filter state persistence**
   - Filter visibility (shown/hidden) is persisted in local storage.
   - Filter inputs (selected status/type/capability, “Mis capacidades”, and `q`) persist for the session at minimum.

8. **Pool view mode: Canvas/List toggle (persisted)**
   - A view toggle exists: “Lienzo” (canvas) / “Lista” (list).
   - The chosen view mode persists in local storage.
   - Canvas mode may allow task cards to overlap.

9. **Card density + hover preview**
   - Cards are compact by default.
   - Pool task cards (available-only) keep `Claim` always visible (no menus).
   - Release/Complete actions for claimed tasks live in the right panel (Now Working / claimed list).
   - Hover on a task card shows an expanded preview area for richer details (future-proofing for additional task fields).

10. **One-click claim**
   - Claiming a task from the Pool is possible with a single click from the task card.

11. **Success metric (layout)**
   - On 1366×768 (browser default zoom, no in-app zoom controls), the Pool workspace supports viewing at least 10 task cards without the filters consuming more than one row when visible.

12. **No coupling with theme palette**
   - The story must not hardcode colors to achieve the layout.
   - Visual darkness/lightness is controlled by theme engine (Story 2.5).

## Notes (future compatibility)
- Tasks may later belong to “fichas”; this story anticipates using a subtle color coding/badge system to indicate membership without adding text clutter.

## Tasks / Subtasks

- [ ] Define layout structure changes (AC: 1, 2)
  - [ ] Confirm right-panel sections for Now Working + claimed list + actions
  - [ ] Ensure Pool workspace gains width/height vs current layout

- [ ] Implement filter row (AC: 3, 5)
  - [ ] Build single-row filter UI
  - [ ] Implement “icon mode” presentation for narrower widths
  - [ ] Add accessible labels/tooltips on hover/click + keyboard focus

- [ ] Implement keyboard shortcuts (AC: 6)
  - [ ] `Ctrl/Cmd+Shift+F` toggles filters
  - [ ] `Ctrl/Cmd+K` opens filters if needed and focuses search
  - [ ] `n` opens create-task UI
  - [ ] Ensure shortcuts are ignored while typing in inputs/selects or when a modal is open

- [ ] Persist UI preferences (AC: 7, 8)
  - [ ] Persist filters visibility (theme default + user override)
  - [ ] Persist view mode (Lienzo/Lista)

- [ ] Implement card behavior (AC: 9, 10)
  - [ ] Ensure actions always visible on cards
  - [ ] Add hover preview expansion area

- [ ] Tests / validation (AC: 6, 7, 8)
  - [ ] Unit tests for keyboard shortcut behavior
  - [ ] Unit tests for persistence keys (filters visibility + view mode)
  - [ ] Basic render tests for filter row icon mode

## Dev Notes

### Inspiration references
- `capturas/5-interfaz-principal.jpg`: three-zone layout; large central workspace
- `capturas/10-vista-proyecto-(en-proceso).jpg`: right panel as personal dashboard
- `capturas/6-listado-miembros-empresa.jpg`: filter row + grid cards

### Storage keys (suggested)
- `sb_pool_filters_visible`: `true|false`
- `sb_pool_view_mode`: `canvas|list`

### Theme contract (final)
- Theme exposes a boolean: `filters_default_visible`.
  - Default theme: true.

### Pool view mode (final)
- The chosen view mode (Canvas/List) persists in local storage.

## Testing
- Client: `apps/client: gleam test`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-15 | 0.1 | Draft story added to Sprint 2 | ux/dev |

## Dev Agent Record

## QA Results
