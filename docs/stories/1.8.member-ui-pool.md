# Story 1.8: Member UI (Pool, Filters, My Bar, Priority/Decay, Positions, Notes)

## Status
Approved

## Story
**As a** project member,
**I want** a responsive pool UI with filters and a personal “my bar”,
**so that** I can claim/release/complete tasks, organize my view, and collaborate via notes.

## Acceptance Criteria
1. **No assignee in UI (negative)**: UI does not expose an “Assignee” field anywhere.
2. **Project selection**: User can select an active project from the projects list (`GET /api/v1/projects`), and the active project is handled client-side in MVP.
3. **Empty state (no projects)**: If `GET /api/v1/projects` returns an empty list, UI clearly indicates the user is not in any project yet and must ask an admin to add them.
4. **Pool view + filters**: For the active project, UI renders tasks list from `GET /api/v1/projects/:project_id/tasks` supporting filters:
   - status (available/claimed/completed)
   - type
   - capability (single value in MVP)
   - `q` search (title/description only)
5. **Create task UI**: Project members can create tasks from the UI (calls `POST /api/v1/projects/:project_id/tasks` with `{ title, description?, priority, type_id }`).
6. **Claim/Release/Complete**: UI supports claiming, releasing, and completing tasks via:
   - `POST /api/v1/tasks/:task_id/claim`
   - `POST /api/v1/tasks/:task_id/release`
   - `POST /api/v1/tasks/:task_id/complete`
7. **My bar**: UI shows a dedicated area listing the user’s claimed tasks.
8. **My skills UI**: User can view and update their capability selection (calls `GET /api/v1/me/capabilities` and `PUT /api/v1/me/capabilities`).
9. **Priority visual**: UI represents priority visually as size (not ordering).
10. **Decay visual**: UI represents task age visually and shows age in days.
11. **Positions per-user**: User can reposition tasks in their view, and positions are persisted per-user via:
   - `GET /api/v1/me/task-positions`
   - `PUT /api/v1/me/task-positions/:task_id`
12. **Notes**: User can read and add append-only notes via:
   - `GET /api/v1/tasks/:task_id/notes`
   - `POST /api/v1/tasks/:task_id/notes`
13. **Responsive**: Pool + bar are mobile-friendly.
14. **CSRF for mutations**: All UI-triggered mutating requests include CSRF double-submit (`sb_csrf` + `X-CSRF`).

## Tasks / Subtasks
- [ ] Implement auth-aware routing (redirect to login when not authenticated) (AC: 2)
- [ ] Implement project selector based on `GET /api/v1/projects` (AC: 2, 3)
- [ ] Implement empty state when user has no projects (AC: 3)
- [ ] Implement pool list with filters + search `q` (AC: 4)
- [ ] Implement create task UI (AC: 5)
- [ ] Implement claim/release/complete actions with conflict handling (AC: 6, 14)
- [ ] Implement “my bar” view (AC: 7)
- [ ] Implement “my skills” view using `/me/capabilities` (AC: 8)
- [ ] Implement priority size mapping (AC: 9)
- [ ] Implement decay factor + days display (AC: 10)
- [ ] Implement drag & drop (or equivalent) to set per-task positions + persistence (AC: 11)
- [ ] Implement notes UI (list + append-only add) (AC: 12)
- [ ] Verify responsive layout (AC: 13)

## Dev Notes
Source of truth:
- MVP UI requirements: `docs/brief.md` (pool, filters, my bar, priority visual, decay visual, responsive, no assignee).
- API calls and constraints: `docs/architecture/api-contract.md`.
- Priority/decay guidance exists in the data model doc:
  - `docs/architecture/data-model.md` (“Decay Calculation”, “Priority Visual Mapping”).

Notes:
- Sorting is server-defined; do not rely on client re-sorting for priority (priority is a visual size).
- Concurrency conflicts: claim and version conflicts must be surfaced to the user (e.g., conflict error message) and UI state reconciled with server.

### Testing
- Use `gleeunit` where applicable (pure functions such as decay/priority mapping).

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-12 | 1.0 | Initial draft | architect |
| 2026-01-12 | 1.1 | Filled key usability gaps: no-projects empty state, create-task UI, and my-skills UI; updated AC/tasks accordingly | architect |
| 2026-01-12 | 1.2 | Approved for implementation (end-to-end member flow coverage) | architect |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
