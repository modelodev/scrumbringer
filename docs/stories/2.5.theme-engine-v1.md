# Story 2.5: Theme engine v1 (tokens + CSS vars + persistencia)

## Status: Draft

## Story
**As a** user,
**I want** to switch between a default theme and a dark theme,
**so that** the UI is comfortable in different lighting conditions and we establish a token-based styling system.

## Acceptance Criteria
1. **Theme tokens exist**: The client defines a small set of design tokens (colors + spacing where applicable) as named values.
2. **CSS variables are the source of truth at runtime**: The app applies theme tokens via CSS variables (e.g. `--sb-bg`, `--sb-fg`, `--sb-muted`, `--sb-border`, `--sb-primary`, `--sb-danger`).
3. **Two themes**: At minimum, `default` and `dark` are supported.
4. **Persistence**: Selected theme is persisted on the client (e.g. localStorage) and restored on reload.
5. **App-wide effect**: Theme affects both Admin and Member surfaces (background, text, borders, and primary action styling at minimum).
6. **Theme switch UI**: There is a theme switch control accessible in the authenticated UI (location is flexible, but must be discoverable).
7. **No server dependency**: Theme selection is client-only (no API calls).

## Tasks / Subtasks
- [ ] Define theme tokens + variable mapping (AC: 1, 2, 3)
  - [ ] Create a dedicated client module for theme definitions (e.g. `scrumbringer_client/theme.gleam`) (AC: 1)
  - [ ] Provide functions to render the active theme as CSS variables (AC: 2)
- [ ] Apply theme variables at the app root (AC: 2, 5)
  - [ ] Ensure the root container sets the variables so all components inherit them (AC: 5)
- [ ] Refactor key UI styling to use CSS variables (AC: 2, 5)
  - [ ] Replace hard-coded colors in shared layout, tables, buttons, and dialogs with vars (AC: 5)
- [ ] Add theme switch UI + state (AC: 6)
  - [ ] Add a theme toggle/select control in the authenticated header (Admin + Member) (AC: 6)
  - [ ] Add message/update logic to switch theme (AC: 3)
- [ ] Persist theme selection (AC: 4)
  - [ ] Read persisted theme at startup (AC: 4)
  - [ ] Write persisted theme on change (AC: 4)
- [ ] Add tests (AC: 3, 4)
  - [ ] Client: serialization/deserialization of theme value (AC: 4)
  - [ ] Client: mapping produces expected CSS vars for both themes (AC: 3)

## Dev Notes
### Source of truth
- Product requirement: responsive, mobile-friendly UI; keep MVP simple: `docs/brief.md` (see “MVP Scope v1.0” and “Risks → Scope creep”).
- Client stack and layout: `docs/architecture/source-tree.md` (see `apps/client/`).

### Implementation note
- Prefer a small token set to avoid premature design-system complexity.

## Testing
- Server: `make test`
- Client: `apps/client: gleam test`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-14 | 1.0 | Initial draft | po |

## Dev Agent Record

## QA Results
