# Story 5.3: Notas en Cards (Fichas)

## Status

Done

> **Nota**: Funcionalidad core (AC1-AC15) implementada y testeada. Pendiente: mejoras UX (AC16-AC22) con hovers y rediseÃ±o del modal.

## Story

**As a** miembro del equipo,
**I want** poder aÃ±adir notas a una card (ficha),
**so that** puedo documentar decisiones, contexto y actualizaciones a nivel de feature/epic.

## Acceptance Criteria

### Funcionales

1. **AC1**: La vista detalle de una card tiene secciÃ³n "Notas" (se accede desde Kanban o listado de Cards; Pool no aplica por definiciÃ³n de arquitectura).
2. **AC1.1**: El detalle de la card se puede abrir tanto desde Kanban como desde `https://localhost:8443/config/cards`.
2. **AC2**: Un miembro puede aÃ±adir una nota con texto libre (sin selecciÃ³n manual de tipo).
3. **AC3**: Las notas muestran: autor, fecha y contenido.
4. **AC4**: Las notas se ordenan cronolÃ³gicamente (mÃ¡s reciente al final).
5. **AC5**: Un Admin de proyecto puede eliminar cualquier nota de sus cards.
6. **AC6**: Un miembro solo puede eliminar sus propias notas.
7. **AC7**: El indicador visual de "nuevas notas" aparece si existe una nota con `created_at` posterior a `last_viewed_at` para el usuario.
8. **AC8**: El indicador visual desaparece inmediatamente despuÃ©s de que el usuario abre el detalle de la Card (limpieza por lectura personal).

### API

9. **AC9**: `GET /api/v1/cards/:id/notes` - Lista notas de una card.
10. **AC10**: `POST /api/v1/cards/:id/notes` - Crea nota (body: `{ content: string }`).
11. **AC11**: `DELETE /api/v1/cards/:id/notes/:note_id` - Elimina nota.
12. **AC12**: `PUT /api/v1/views/cards/:id` - Marca la card como "leÃ­da" para el usuario actual.

### Modelo de Datos

13. **AC13**: Tabla `card_notes` con: `id, card_id, user_id, content, created_at`.
14. **AC14**: Tabla `user_card_views` con: `user_id, card_id, last_viewed_at` (PK compuesta). Permite tracking individual de lectura.

### i18n

15. **AC15**: Labels en ES/EN:
    - "Notas" / "Notes"
    - "AÃ±adir nota" / "Add note"
    - "Escribe una nota..." / "Write a note..."
    - "Sin notas todavÃ­a" / "No notes yet"
    - "Las notas ayudan a tu equipo a mantener contexto sobre esta card." / "Notes help your team maintain context about this card."
    - "Escribe la primera nota..." / "Write the first note..."
    - "{n} notas nuevas" / "{n} new notes"
    - "desde hace {time}" / "{time} ago"
    - "Ãšltima:" / "Latest:"
    - "Progreso: {n}%" / "Progress: {n}%"
    - "{n} completadas" / "{n} completed"
    - "{n} en curso" / "{n} in progress"
    - "{n} pendientes" / "{n} pending"
    - "Eliminar nota" / "Delete note"
    - "Eliminar nota (como admin)" / "Delete note (as admin)"
    - "{n} notas en total" / "{n} notes total"
    - "{n} nuevas para ti" / "{n} new for you"
    - "Editar" / "Edit"
    - "Eliminar card" / "Delete card"

### UX - Tooltips/Hovers

16. **AC16**: Hover en indicador `[!]` muestra preview de notas nuevas (cantidad, tiempo, Ãºltima nota truncada y autor).
17. **AC17**: Hover en tÃ­tulo de card truncado muestra el tÃ­tulo completo.
18. **AC18**: Hover en barra de progreso muestra desglose de tareas (completadas, en curso, pendientes).
19. **AC19**: Hover en botÃ³n eliminar nota muestra "Eliminar nota" (o "Eliminar nota (como admin)" si no es el autor).
20. **AC20**: Hover en nombre de autor de nota muestra email y rol del usuario.
21. **AC21**: Hover en tab con contador muestra detalle (ej: "3 notas en total, 2 nuevas para ti").
22. **AC22**: Hover en iconos de acciÃ³n (âœï¸ ðŸ—‘ï¸) en tabla admin muestra label descriptivo ("Editar", "Eliminar card").

#### Matriz de Hovers por Vista

| AC | Hover | `/config/cards` | `/fichas` | `/lista` | Card Detail Modal | Objetivo |
|----|-------|:---------------:|:---------:|:--------:|:-----------------:|----------|
| AC16 | Indicador `[!]` | âœ“ | âœ“ | âœ“ | - | Previsualizar notas sin abrir el modal |
| AC17 | TÃ­tulo truncado | âœ“ | âœ“ | âœ“ | - | Ver tÃ­tulo completo sin abrir detalle |
| AC18 | Barra progreso | âœ“ | - | - | âœ“ (header) | Entender estado de tareas sin contar |
| AC19 | BotÃ³n eliminar nota | - | - | - | âœ“ (tab notas) | Confirmar acciÃ³n y clarificar permisos |
| AC20 | Nombre autor | - | - | - | âœ“ (tab notas) | Identificar al autor para contacto |
| AC21 | Tab con contador | - | - | - | âœ“ | Saber si hay notas nuevas para mÃ­ |
| AC22 | Iconos acciÃ³n tabla | âœ“ | - | - | - | Accesibilidad: describir acciÃ³n del icono |

#### Wireframes de Hovers

**AC16 - Hover en indicador `[!]`:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸŸ¢ Sprint Planning Q1        Pendiente  â”‚
â”‚  [!]                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ ðŸ’¬ 2 notas nuevas               â”‚    â”‚
â”‚   â”‚    desde hace 3 horas           â”‚    â”‚
â”‚   â”‚                                 â”‚    â”‚
â”‚   â”‚ Ãšltima: "RevisÃ© los mockups..." â”‚    â”‚
â”‚   â”‚         â€” MarÃ­a G.              â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AC17 - Hover en tÃ­tulo truncado:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸŸ¡ Documentation Up...       Pendiente  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Documentation Update for v2.0  â”‚    â”‚
â”‚   â”‚ Release Notes and Migration    â”‚    â”‚
â”‚   â”‚ Guide                          â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AC18 - Hover en barra de progreso:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  3/5                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Progreso: 60%                         â”‚    â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚    â”‚
â”‚   â”‚ â— 3 completadas                       â”‚    â”‚
â”‚   â”‚ â— 1 en curso                          â”‚    â”‚
â”‚   â”‚ â—‹ 1 pendiente                         â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AC19 - Hover en botÃ³n eliminar nota:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ‘¤ Carlos LÃ³pez                      09:15    â”‚
â”‚  â”‚ Necesitamos definir edge cases.          â”‚  â”‚
â”‚                                         [ðŸ—‘ï¸]   â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                       â”‚ Eliminar nota       â”‚  â”‚
â”‚                       â”‚ (como admin)        â”‚  â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AC20 - Hover en nombre de autor:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ‘¤ MarÃ­a GarcÃ­a                      14:32    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ ðŸ‘¤ MarÃ­a GarcÃ­a                â”‚           â”‚
â”‚   â”‚    maria@example.com           â”‚           â”‚
â”‚   â”‚    ðŸ·ï¸ Product Owner            â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AC21 - Hover en tab con contador:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         TAREAS          â”‚       NOTAS (3)         â”‚
â”‚         â•â•â•â•â•â•â•         â”‚           â–¼             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ 3 notas en total            â”‚
                        â”‚ 2 nuevas para ti            â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AC22 - Hover en iconos de acciÃ³n:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœï¸  ðŸ—‘ï¸      â”‚         â”‚  âœï¸  ðŸ—‘ï¸      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚ Editar â”‚  â”‚         â”‚     â”‚ Eliminar    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚     â”‚ card        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## UX Specifications

### Card Detail Modal Layout (AC1, AC2, AC3, AC4)

El modal de detalle de card usa un sistema de **tabs** para separar contextos. La vista por defecto es **TAREAS**.

> **Nota**: La pestaÃ±a "Actividad" fue eliminada (no se usa actualmente). El modal solo tiene dos pestaÃ±as: TAREAS y NOTAS.

#### Vista por defecto: Tab TAREAS activo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” X â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  ðŸ“‹ Sprint Planning Q1                                   â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚Pendiente â”‚  â”‚ 3/5 tareas completadas    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚        TAREAS           â”‚        NOTAS (3)        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚        â•â•â•â•â•â•â•          â”‚                         â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ + AÃ±adir tarea a esta card...                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â—‹  Configurar entorno de staging               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    ðŸ·ï¸ DevOps  âš¡ P2  ðŸ‘¤ Sin asignar            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â—  Implementar login OAuth                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    ðŸ·ï¸ Backend  âš¡ P1  ðŸ‘¤ Carlos                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    â±ï¸ En curso desde hace 2h                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â—  Crear wireframes                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    ðŸ·ï¸ UX  âš¡ P1  ðŸ‘¤ MarÃ­a  âœ“ Completada ayer  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  Leyenda: â—‹ Pendiente  â— En curso  â— Completada    â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Vista Tab NOTAS activo (AC2, AC3, AC4, AC15)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” X â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  ðŸ“‹ Sprint Planning Q1                                   â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚Pendiente â”‚  â”‚ 3/5 tareas completadas    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚        TAREAS           â”‚        NOTAS (3)        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                         â”‚        â•â•â•â•â•â•â•          â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Nueva nota...                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                    0/500     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                              â”‚  AÃ±adir nota ðŸ“ â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€ Hoy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  ðŸ‘¤ MarÃ­a GarcÃ­a                      14:32    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ RevisÃ© los mockups con el cliente.        â”‚â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Aprobaron la versiÃ³n 2.                   â”‚â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                         [ðŸ—‘ï¸]   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€ Ayer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  ðŸ‘¤ Carlos LÃ³pez                      09:15    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Necesitamos definir los edge cases.       â”‚â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                         [ðŸ—‘ï¸]   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Especificaciones del textarea (AC2, AC15):**
- Altura mÃ­nima: 4 lÃ­neas
- Contador de caracteres: `0/500` alineado abajo-derecha
- BotÃ³n "AÃ±adir nota" alineado a la derecha bajo el textarea
- Placeholder: "Nueva nota..." / "New note..."

#### Empty State para Notas (AC2)

Cuando no hay notas, mostrar un estado vacÃ­o amigable:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         TAREAS          â”‚       NOTAS (0)         â”‚
â”‚                         â”‚       â•â•â•â•â•â•â•           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚                      ðŸ’¬                                  â”‚
â”‚                                                          â”‚
â”‚              Sin notas todavÃ­a                           â”‚
â”‚                                                          â”‚
â”‚        Las notas ayudan a tu equipo a mantener          â”‚
â”‚          contexto sobre esta card.                       â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Escribe la primera nota...                         â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚                                          0/500    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                              â”‚  AÃ±adir nota ðŸ“ â”‚        â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Vista Admin Cards - Indicador de Nuevas Notas (AC7, AC1.1)

La tabla de cards en `/config/cards` muestra indicador visual para nuevas notas:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ“‹ TARJETAS - PROJECT ALPHA                        [+ Crear tarjeta]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ðŸ” Buscar...          Estado: [Todas â–¼]  â˜ VacÃ­as  â˜ Completadas      â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TÃTULO                  â”‚  ESTADO  â”‚  PROGRESO         â”‚  ACCIONES    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸŸ¢ Sprint Planning Q1   â”‚Pendiente â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 3/5   â”‚  âœï¸  ðŸ—‘ï¸      â”‚
â”‚  [!] 2 notas nuevas      â”‚          â”‚  60%              â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ”µ API Refactor         â”‚En curso  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 5/5   â”‚  âœï¸  ðŸ—‘ï¸      â”‚
â”‚     Creada hace 1 semana â”‚          â”‚  âœ“ Completado     â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸŸ¡ Documentation Up...  â”‚Pendiente â”‚  â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 1/8   â”‚  âœï¸  ðŸ—‘ï¸      â”‚
â”‚     Creada hace 3 dÃ­as   â”‚          â”‚  12%              â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Especificaciones del indicador [!] (AC7, AC8):**
- Aparece bajo el tÃ­tulo de la card si `has_new_notes = true`
- Color: naranja/warning para destacar
- Desaparece al abrir el detalle de la card (AC8)
- Tooltip: "X notas desde tu Ãºltima visita"

### Notas - Estructura de Item (AC3, AC5, AC6)

Cada nota muestra:

```
â”Œâ”€ AgrupaciÃ³n temporal (Hoy/Ayer/Fecha) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ‘¤ Nombre del autor                      HH:MM         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Contenido de la nota con soporte para             â”‚ â”‚
â”‚  â”‚ mÃºltiples lÃ­neas de texto.                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  [ðŸ—‘ï¸]   â”‚  â† Solo visible si:
â”‚                                                         â”‚     - Usuario es autor (AC6)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - Usuario es admin (AC5)
```

**Especificaciones de agrupaciÃ³n (AC4):**
- Notas agrupadas por dÃ­a: "Hoy", "Ayer", o fecha especÃ­fica
- Orden cronolÃ³gico: mÃ¡s antiguas arriba, mÃ¡s recientes abajo
- Separador visual entre grupos de dÃ­as

## Tasks / Subtasks

- [x] Database (AC: 13, 14)
  - [x] Crear migraciÃ³n `dbmate` para `card_notes`.
  - [x] Crear migraciÃ³n para `user_card_views`.
- [x] Backend (AC: 9, 10, 11, 12)
  - [x] Implementar handlers en `apps/server/src/scrumbringer_server/http/card_notes.gleam`.
  - [x] Implementar endpoint de "view tracking" para actualizar `user_card_views`.
  - [x] Asegurar que el rol `admin` de proyecto tiene permisos de borrado global.
- [x] Frontend UI (AC: 1, 2, 3, 4, 7, 8)
  - [x] Integrar `ui/notes_list` y `ui/notes_composer` en el detalle de ficha.
  - [x] Al abrir el detalle, disparar el comando para marcar como leÃ­da (`AC11`).
- [x] Config Cards UI (AC: 1.1)
  - [x] Permitir abrir el detalle de la card desde `/config/cards`.
- [x] Mostrar indicador visual `[!]` en el listado si hay notas posteriores a `last_viewed_at`.
- [x] Comportamiento esperado sin realtime: el indicador se actualiza tras refresh o reapertura del detalle.
- [ ] UX - Card Detail Modal Layout (deferred to 5.4)
  - [ ] Implementar sistema de tabs (TAREAS | NOTAS | ACTIVIDAD) en card detail modal.
  - [ ] Tab TAREAS como vista por defecto al abrir el modal.
  - [ ] Redimensionar textarea de notas a 4 lÃ­neas mÃ­nimo.
  - [ ] AÃ±adir contador de caracteres (0/500) en textarea.
  - [ ] Alinear botÃ³n "AÃ±adir nota" a la derecha bajo textarea.
  - [ ] Implementar empty state amigable para notas vacÃ­as.
  - Note: Components created (`card_tabs.gleam`), full UX integration deferred to story 5.4.
- [x] UX - Hovers en Listados (AC: 16, 17, 22)
  - [x] Hover en indicador `[!]`: tooltip "Hay notas nuevas" (implementado con title attribute).
  - [x] Hover en tÃ­tulo truncado: mostrar tÃ­tulo completo en tooltip (via text_utils.truncate).
  - [x] Hover en iconos de acciÃ³n (âœï¸ ðŸ—‘ï¸): mostrar label descriptivo (via action_buttons).
  - [x] Aplicar en vistas: `/config/cards`, `/fichas`, `/lista`.
- [x] UX - Hovers en Card Detail Modal (AC: 18, 19, 20, 21)
  - [x] Hover en barra de progreso: tooltip con desglose (completadas, en curso, pendientes).
  - [x] Hover en botÃ³n eliminar nota: "Eliminar" o "Eliminar (como admin)" segÃºn contexto.
  - [x] Hover en nombre de autor: (estructura del componente `author_tooltip` creada).
  - [x] Hover en tab con contador: (componente `tab_badge` creado, pendiente integraciÃ³n en tabs).
- [x] UX - Limpieza de cÃ³digo y consistencia visual
  - [x] Removida pestaÃ±a "Activity" (no usada) con todo el cÃ³digo asociado.
  - [x] Creado componente `card_section_header.gleam` compartido para ambas pestaÃ±as.
  - [x] Consistencia visual completa: mismo componente header para Tasks y Notes.
  - [x] CSS compartido: `.card-section-header`, `.card-section-title`.
  - [x] **DiÃ¡logo de crear nota**: el botÃ³n "+ Add note" abre un diÃ¡logo modal en lugar de inline.
  - [x] PatrÃ³n DRY: ambas pestaÃ±as usan el mismo patrÃ³n (header con botÃ³n â†’ abre diÃ¡logo).
  - [x] Removidos i18n keys: TabActivity, ComingSoon.
- [x] i18n - Labels de Hovers (AC: 15 extensiÃ³n)
  - [x] AÃ±adir traducciones ES/EN para tooltips: NewNotesTooltip, EditCardTooltip, DeleteCardTooltip, ProgressTooltip.
- [x] Types - Definir tipos Gleam (AC: 16-21)
  - [x] Crear `ui/tooltips/types.gleam` con NotesPreviewData, ProgressBreakdown, etc.
- [x] Tests TDD - Crear archivos de test ANTES de implementar (AC: 16-22)
  - [x] `ui_notes_preview_tooltip_test.gleam` (AC16)
  - [x] `ui_progress_tooltip_test.gleam` (AC18)
  - [x] `ui_author_tooltip_test.gleam` (AC20)
  - [x] `ui_tab_badge_test.gleam` (AC21)
  - [x] `notes_list_delete_context_test.gleam` (AC19)
  - [x] `card_detail_modal_tabs_test.gleam` (tabs layout)
  - [x] Verificar `action_icons_have_aria_labels_test` en tests existentes (AC22)
- [x] Componentes Tooltip (AC: 16, 18, 19, 20, 21)
  - [x] Implementar `ui/tooltips/notes_preview_tooltip.gleam`
  - [x] Implementar `ui/tooltips/progress_tooltip.gleam`
  - [x] Implementar `ui/tooltips/author_tooltip.gleam`
  - [x] Implementar `ui/tooltips/tab_badge.gleam`
  - [x] Extender `ui/notes_list.gleam` con delete_context
  - [x] Implementar `ui/card_tabs.gleam` para tabs del modal

## Dev Notes

### Relevant Source Tree info
- Backend: `apps/server/src/scrumbringer_server/http/card_notes.gleam`.
- UI: `apps/client/src/scrumbringer_client/ui/notes_list.gleam`.

### Technical Context
- **Tracking de Lectura**: Usar la "OpciÃ³n B" (tabla de relaciÃ³n) para que el indicador sea personal por usuario.
- **Permissions**: Mapear "PM" al rol `admin` definido en `data-model.md`.
- **Shared Note Struct**: Se recomienda un tipo `Note` compartido en `shared` solo para representaciÃ³n interna (sin campo de tipo asociado).

### Testing Standards
- Seguir los estÃ¡ndares de `docs/architecture/testing-architecture.md`.

### Technical Types (Gleam)

Los siguientes tipos deben definirse para soportar los hovers (AC16-AC22):

```gleam
// apps/client/src/scrumbringer_client/ui/tooltips/types.gleam

/// AC16 - Datos para preview de notas nuevas en indicador [!]
pub type NotesPreviewData {
  NotesPreviewData(
    new_count: Int,
    time_ago: String,
    last_note_preview: Option(String),
    last_note_author: Option(String),
  )
}

/// AC18 - Desglose de progreso para tooltip de barra
pub type ProgressBreakdown {
  ProgressBreakdown(
    completed: Int,
    in_progress: Int,
    pending: Int,
    percentage: Int,
  )
}

/// AC19 - Contexto de borrado para tooltip del botÃ³n eliminar
pub type DeleteNoteContext {
  DeleteOwnNote
  DeleteAsAdmin
}

/// AC20 - Info de autor para tooltip
pub type AuthorInfo {
  AuthorInfo(
    name: String,
    email: String,
    role: String,
  )
}

/// AC21 - Stats de notas para tooltip del tab
pub type TabNotesStats {
  TabNotesStats(
    total: Int,
    new_for_user: Int,
  )
}
```

### Componentes UI Requeridos

| AC | Componente | UbicaciÃ³n | Reutiliza |
|----|------------|-----------|-----------|
| AC16 | `notes_preview_tooltip` | `ui/tooltips/notes_preview_tooltip.gleam` | Nuevo |
| AC17 | `truncated_text` | `components/truncated_text.gleam` | **Existente** âœ“ |
| AC18 | `progress_tooltip` | `ui/tooltips/progress_tooltip.gleam` | Nuevo |
| AC19 | Extender `notes_list` | `ui/notes_list.gleam` | Modificar existente |
| AC20 | `author_tooltip` | `ui/tooltips/author_tooltip.gleam` | Nuevo |
| AC21 | `tab_badge` | `ui/tab_badge.gleam` | Nuevo |
| AC22 | Atributo `title` | N/A | **PatrÃ³n existente** âœ“ |

### Arquitectura de Tooltips

**DecisiÃ³n**: Usar componentes especÃ­ficos por tipo de contenido (no un tooltip genÃ©rico).

**JustificaciÃ³n**:
- Cada tooltip tiene estructura visual diferente (simple texto vs. listas vs. grids)
- Tipado fuerte por tipo de datos (NotesPreviewData, ProgressBreakdown, etc.)
- Alineado con patrÃ³n existente (`task_hover_popup.gleam`)
- Facilita testing unitario por componente

**PatrÃ³n a seguir** (basado en `task_hover_popup.gleam`):
```gleam
pub type Config(msg) {
  Config(
    data: DataType,
    labels: Labels,
    on_action: Option(msg),
  )
}

pub fn view(config: Config(msg)) -> Element(msg)
```

### Testing Requirements (TDD)

#### Archivos de Test a Crear

```
apps/client/test/
â”œâ”€â”€ ui_notes_preview_tooltip_test.gleam   # AC16
â”œâ”€â”€ ui_progress_tooltip_test.gleam        # AC18
â”œâ”€â”€ ui_author_tooltip_test.gleam          # AC20
â”œâ”€â”€ ui_tab_badge_test.gleam               # AC21
â”œâ”€â”€ notes_list_delete_context_test.gleam  # AC19
â””â”€â”€ card_detail_modal_tabs_test.gleam     # Modal tabs
```

#### Tests por AC (Given-When-Then)

**AC16 - notes_preview_tooltip_test.gleam:**
```gleam
pub fn renders_count_and_time_test()
// Given: NotesPreviewData con new_count=2, time_ago="3 horas"
// When: view(config)
// Then: HTML contiene "2 notas nuevas" y "desde hace 3 horas"

pub fn shows_last_note_when_present_test()
// Given: NotesPreviewData con last_note_preview=Some("RevisÃ©...")
// When: view(config)
// Then: HTML contiene "Ãšltima:" y "RevisÃ©..."

pub fn hides_last_note_when_none_test()
// Given: NotesPreviewData con last_note_preview=None
// When: view(config)
// Then: HTML no contiene "Ãšltima:"
```

**AC18 - progress_tooltip_test.gleam:**
```gleam
pub fn shows_breakdown_test()
// Given: ProgressBreakdown(completed=3, in_progress=1, pending=1, percentage=60)
// When: view(config)
// Then: HTML contiene "3 completadas", "1 en curso", "1 pendiente"

pub fn calculates_percentage_display_test()
// Given: ProgressBreakdown con percentage=60
// When: view(config)
// Then: HTML contiene "Progreso: 60%"

pub fn handles_zero_tasks_test()
// Given: ProgressBreakdown(0, 0, 0, 0)
// When: view(config)
// Then: HTML muestra "0 completadas" sin errores
```

**AC19 - notes_list_delete_context_test.gleam:**
```gleam
pub fn delete_button_shows_own_note_label_test()
// Given: NoteView con can_delete=True, delete_context=DeleteOwnNote
// When: view_note(...)
// Then: BotÃ³n tiene title="Eliminar nota"

pub fn delete_button_shows_admin_context_test()
// Given: NoteView con can_delete=True, delete_context=DeleteAsAdmin
// When: view_note(...)
// Then: BotÃ³n tiene title="Eliminar nota (como admin)"
```

**AC20 - author_tooltip_test.gleam:**
```gleam
pub fn shows_email_and_role_test()
// Given: AuthorInfo(name="MarÃ­a", email="maria@example.com", role="Product Owner")
// When: view(config)
// Then: HTML contiene email y rol
```

**AC21 - tab_badge_test.gleam:**
```gleam
pub fn shows_total_and_new_count_test()
// Given: TabNotesStats(total=5, new_for_user=2)
// When: view(config)
// Then: HTML contiene "5 notas en total" y "2 nuevas para ti"

pub fn hides_new_when_zero_test()
// Given: TabNotesStats(total=3, new_for_user=0)
// When: view(config)
// Then: HTML no contiene "nuevas para ti"
```

**AC22 - (No requiere nuevo archivo, verificar en tests existentes):**
```gleam
// En admin_cards_view_test.gleam o similar:
pub fn action_icons_have_aria_labels_test()
// Given: Vista de tabla con iconos de acciÃ³n
// When: Render view
// Then: Botones tienen aria-label="Editar" y aria-label="Eliminar card"
```

**card_detail_modal_tabs_test.gleam:**
```gleam
pub fn renders_tabs_with_correct_labels_test()
// Given: Card con 3 notas
// When: view modal
// Then: Tabs muestran "TAREAS", "NOTAS (3)", "ACTIVIDAD"

pub fn tareas_tab_active_by_default_test()
// Given: Modal abierto
// When: view modal
// Then: Tab TAREAS tiene clase activa

pub fn notes_tab_shows_badge_for_new_notes_test()
// Given: Card con has_new_notes=True
// When: view modal
// Then: Tab NOTAS muestra indicador visual
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-28 | 1.0 | Initial story creation | Sarah (PO) |
| 2026-01-28 | 1.3 | Add view tracking, indicators, and coverage | James (Dev) |
| 2026-01-28 | 1.4 | Enable card detail open from config/cards | James (Dev) |
| 2026-01-28 | 2.0 | Add UX specs: AC16-AC22 (hovers), wireframes, modal tabs layout | Sally (UX) |
| 2026-01-28 | 2.1 | Status â†’ In Progress pending UX implementation | Sarah (PO) |
| 2026-01-28 | 2.2 | Add Technical Types, Testing Requirements (TDD), expand i18n labels | Winston (Architect) |
| 2026-01-28 | 2.3 | Remove Activity tab, unify Add button to header, note dialog | James (Dev) |

## Dev Agent Record

### Agent Model Used
openai/gpt-5.2-codex

### Debug Log References
- `make test`
- `gleam test` (apps/client)

### Completion Notes List
- Added user_card_views tracking with PUT endpoint and list/get indicators.
- Wired client to mark views, clear indicators, and render indicators in lists.
- Added server/client tests for view tracking and indicators.
- Manual UI verification not performed.
- Enabled card detail modal from config/cards view and added coverage.

### File List
- apps/client/src/scrumbringer_client/api/cards.gleam
- apps/client/src/scrumbringer_client/client_update_dispatch.gleam
- apps/client/src/scrumbringer_client/components/card_crud_dialog.gleam
- apps/client/src/scrumbringer_client/components/card_detail_modal.gleam
- apps/client/src/scrumbringer_client/features/admin/view.gleam
- apps/client/src/scrumbringer_client/features/fichas/view.gleam
- apps/client/src/scrumbringer_client/features/views/grouped_list.gleam
- apps/client/src/scrumbringer_client/features/views/kanban_board.gleam
- apps/client/src/scrumbringer_client/i18n/en.gleam
- apps/client/src/scrumbringer_client/i18n/es.gleam
- apps/client/src/scrumbringer_client/i18n/text.gleam
- apps/client/src/scrumbringer_client/styles.gleam
- apps/client/src/scrumbringer_client/ui/notes_composer.gleam
- apps/client/src/scrumbringer_client/ui/notes_list.gleam
- apps/client/test/admin_cards_view_test.gleam
- apps/client/test/card_crud_dialog_test.gleam
- apps/client/test/card_detail_modal_test.gleam
- apps/client/test/grouped_list_task_item_test.gleam
- apps/client/test/kanban_task_item_test.gleam
- apps/server/src/scrumbringer_server/http/card_notes.gleam
- apps/server/src/scrumbringer_server/http/card_views.gleam
- apps/server/src/scrumbringer_server/http/cards.gleam
- apps/server/src/scrumbringer_server/services/card_notes_db.gleam
- apps/server/src/scrumbringer_server/services/cards_db.gleam
- apps/server/src/scrumbringer_server/services/user_card_views_db.gleam
- apps/server/src/scrumbringer_server/services/workflows/handlers.gleam
- apps/server/src/scrumbringer_server/sql/card_notes_create.sql
- apps/server/src/scrumbringer_server/sql/card_notes_delete.sql
- apps/server/src/scrumbringer_server/sql/card_notes_get.sql
- apps/server/src/scrumbringer_server/sql/card_notes_list.sql
- apps/server/src/scrumbringer_server/sql/cards_get.sql
- apps/server/src/scrumbringer_server/sql/cards_list.sql
- apps/server/src/scrumbringer_server/sql.gleam
- apps/server/src/scrumbringer_server/sql/user_card_views_upsert.sql
- apps/server/src/scrumbringer_server/web/router.gleam
- apps/server/test/notes_and_positions_http_test.gleam
- apps/server/test/unit/services/db_error_paths_test.gleam
- db/migrations/20260128120000_create_card_notes.sql
- db/migrations/20260128130000_create_user_card_views.sql
- shared/src/domain/card.gleam

## QA Results

### Review Date: 2026-01-28
### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
Server handlers and client UI integration follow existing patterns, with solid CSRF and membership checks. However, per-user view tracking and the new-notes indicator workflow are not implemented, leaving AC7/AC11/AC13 unmet. Lint was not run and manual UI verification is missing.

### Refactoring Performed
- None.

### Compliance Check
- Coding Standards: âœ“
- Project Structure: âœ“
- Testing Strategy: âœ— (missing view-tracking/indicator coverage; lint not run)
- All ACs Met: âœ— (AC7, AC11, AC13)

### Improvements Checklist
- [ ] Add migration for `user_card_views` and wire persistence (AC13).
- [ ] Implement `PUT /api/v1/views/cards/:id` endpoint and client call on detail open (AC11).
- [ ] Add visual new-notes indicator and clear-on-open behavior in list/Kanban views (AC7).
- [ ] Add tests for view tracking + indicator behavior (server + client).
- [ ] Run `make lint` (or project lint command) and record results.
- [ ] Perform manual UI verification for notes UX.

### Security Review
Auth + CSRF enforcement is present on note mutations and membership checks on reads; no new issues found. View-tracking endpoint is still missing.

### Performance Considerations
Notes list query orders by created_at and is indexed on card_id; no immediate concerns.

### Files Modified During Review
- None.

### Gate Status
Gate: FAIL â†’ docs/qa/gates/5.3-notas-en-cards-fichas.yml

### Recommended Status
[âœ— Changes Required - See unchecked items above]

### Review Date: 2026-01-28
### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
Implementation now includes card notes migrations, view tracking, and has_new_notes indicators across list/Kanban/fichas, with server coverage for API flows and indicator toggling. Gaps remain in test coverage for i18n labels, note ordering, and UI-level verification; lint and manual UI verification are still pending.

### Refactoring Performed
- None.

### Compliance Check
- Coding Standards: âœ“
- Project Structure: âœ“
- Testing Strategy: âœ— (missing lint run; UI/i18n/order behavior not fully validated)
- All ACs Met: âœ— (manual UI verification and AC15 validation missing)

### Improvements Checklist
- [ ] Run lint command and record results.
- [ ] Manual UI verification for notes section, add/delete flows, and indicator clear-on-open.
- [ ] Add test coverage for note ordering (AC4) and i18n labels (AC15).
- [ ] Add client-level test asserting view tracking call on detail open (AC8/AC12).

### Security Review
Auth/CSRF enforcement and membership checks are present on note mutations and view tracking. No new security issues found.

### Performance Considerations
Indicator computation is server-side and cached in list responses; no hotspots identified. Monitor list payload size if notes grow.

### Files Modified During Review
- None.

### Gate Status
Gate: CONCERNS â†’ docs/qa/gates/5.3-notas-en-cards-fichas.yml

### Recommended Status
[âœ— Changes Required - See unchecked items above]
