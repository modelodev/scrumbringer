# Story 3.0 (Sprint 3 kickoff): i18n (ES/EN) + hover popover en Pool + cronómetro acumulado

## Status: Done

## Story
**As a** user,
**I want** to use Scrumbringer in Spanish or English and get clear, accessible hover details in the Pool,
**so that** I can work comfortably in my preferred language and understand tasks quickly.

## Context
- Esta historia debe ser la **primera** en ejecutarse en el Sprint 3.
- Queremos profesionalizar i18n (sin “stringly-typed keys” desperdigadas) con un enfoque idiomático en Gleam.
- El hover preview actual del Pool se ve “debuggy” y no aparece en `:focus-within`.
- Bug reportado: en “Now Working”, el cronómetro **reinicia** al pausar y reanudar la misma tarea; queremos que el tiempo sea **acumulado** (por usuario + tarea) en pausas/reanudaciones.

## Acceptance Criteria
1. **i18n base (ES/EN) sin ensuciar el código**
   - La app soporta al menos `es` y `en`.
   - El idioma por defecto se detecta por navegador (e.g., `navigator.language`) y se persiste en local storage para sesiones futuras.
   - No quedan strings **user-facing** hardcoded en componentes/vistas: toda UI debe renderizar textos desde `i18n.t(locale, Text)`.
   - Excepciones explícitas (permitidas): nombres de clases CSS, `data-*`, keys técnicas, logs/debug y fixtures/tests.

2. **Cobertura de traducción: toda la UI actual**
   - Todos los textos user-facing existentes quedan traducidos (ES/EN), incluyendo:
     - Member UI: Pool, My Bar, My Skills, Now Working.
     - Admin UI: Projects/Members/Capabilities/Task Types/Metrics/Org settings.
     - Login / Accept invite / Reset password.
   - Labels y textos de accesibilidad (`aria-label`, `alt`, tooltips visibles) también se traducen.

3. **Pool: hover popover limpio con flecha (propuesta 1C)**
   - En modo canvas, el hover de una task card muestra un popover con:
     - Fondo, borde, padding y sombra acorde al sistema visual.
     - Una flecha discreta que conecte el popover con la card.
   - Accesibilidad (decisión cerrada):
     - El popover debe tener `role="tooltip"`.
     - El trigger debe apuntar al tooltip con `aria-describedby`.
     - Debe aparecer tanto en `:hover` (con delay) como en `:focus-within` (teclado, sin delay).
   - Layout del contenido (para evitar aspecto “debuggy”):
     - Estructura tipo mini-card (no texto crudo `key: value` apilado sin jerarquía).
     - Mostrar pares **Etiqueta / Valor** con buen espaciado (estilo “definition list” o grid 2 columnas).
     - `status` se muestra como badge (texto + color, no solo color).
     - Evitar wraps feos para valores cortos (p.ej. que `available` salte a línea nueva).
   - i18n:
     - El contenido del popover usa i18n para **labels**.
     - **No traduce valores provenientes de DB** (p.ej. type name `Bug`, status raw `available`).
   - Affordances (alineado con el brief MVP):
     - En tarjetas del Pool, los affordances críticos deben ser siempre visibles y usables: acción (Claim/Release/Complete según estado) y el handle de drag.
     - El botón de acción (p.ej. `Claim`) debe ser un `button` accesible (`aria-label` traducido + focus ring visible) y no depender de hover para ser usable.
   - Claim (botón + drag-to-claim):
     - **Botón Claim (camino universal):** siempre visible en la card (icon-only y secondary por defecto; se enfatiza en hover/focus-within).
     - **Drag-to-claim (atajo potente):** arrastrar una tarea del canvas al panel derecho `Mis tareas` hace Claim, con feedback claro:
       - El área `Mis tareas` actúa como dropzone con estados visuales: drag activo (hint), drag over (ready), drop ok (la tarea desaparece del Pool y aparece en Mis tareas), drop fail (toast + rollback).
       - Anti-accidentes: el Claim ocurre solo al soltar dentro del dropzone.
     - Nota de alcance: si `drag-to-claim` no queda estable dentro de esta story, se difiere a story futura sin bloquear el cierre.
   - Ejemplo ES (labels traducidos, valores DB sin traducir):
     - `Tipo: Bug`
     - `Creada: hace 1 día`
     - `Estado: available`

4. **Now Working: cronómetro acumulado por tarea**
   - Si el usuario hace `Start` sobre una tarea, deja correr 1 minuto, hace `Pause`, y luego vuelve a `Start` la misma tarea:
     - El cronómetro continúa desde el tiempo previamente acumulado (no reinicia a 0).
   - El acumulado es personal (por usuario) y no afecta al estado global del Pool.
   - Si el usuario cambia de tarea activa, el tiempo acumulado se registra correctamente para la tarea previa.
   - El acumulado se persiste server-side por `(user_id, task_id)` en tabla `user_task_now_working_time` como `accumulated_s` (segundos).
   - Mientras exista una tarea activa, el cliente envía un heartbeat cada 60s y el servidor actualiza el acumulado; además se actualiza en pause/switch/release/complete.

5. **Tests / Validación**
   - Se añaden pruebas de unidad para:
     - Resolución de locale (browser language) + persistencia.
     - Traducciones: al menos un set de “smoke tests” que cubran que `t(Es, …)` y `t(En, …)` devuelven strings no vacíos para un subconjunto representativo.
     - Cronómetro acumulado: server-side y/o client-side decode/logic (mínimo) cubriendo pause/resume.
   - Playwright:
     - Evidencia visual del popover (hover) es **nice-to-have** y **NO bloqueante** en esta story (si no está estable, se difiere a una story futura).
     - Verificación funcional de accesibilidad del popover (`role="tooltip"` + `aria-describedby`) es recomendada pero no bloqueante.

## Tasks / Subtasks
- [x] Task 1: Añadir infraestructura i18n tipada (AC: 1)
  - [x] Crear módulos `i18n` (Locale + Text + t)
  - [x] Detección inicial por navegador y persistencia en local storage
  - [x] Añadir estado de `locale` al modelo del cliente

- [x] Task 2: Migrar toda la UI actual a i18n (AC: 2)
  - [x] Sustituir literales por `i18n.t(locale, ...)` en todas las pantallas
  - [x] Traducir labels de accesibilidad (`aria-label`, `alt`, tooltips)
  - [x] Verificar que no quedan strings user-facing “hardcoded” fuera de i18n

- [x] Task 3: Rediseñar hover preview como popover con flecha (AC: 3)
  - [x] Ajustar markup/CSS del popover para que sea una mini tarjeta (fondo/borde/sombra)
  - [x] Añadir flecha (pseudo-element)
  - [x] Mostrar en `:hover` y `:focus-within`
  - [x] Humanizar contenido (Tipo/Creada/Estado) a través de i18n
  - [x] (Opcional / NO bloqueante) Pool: drag-to-claim hacia panel `Mis tareas`
    - [x] Hacer que el panel derecho `Mis tareas` actúe como dropzone con estados visuales (drag activo / drag over / drop ok / drop fail)
    - [x] Asegurar anti-accidentes: claim solo al soltar dentro del dropzone

- [x] Task 4: Fix Now Working timer: acumulado pausa/reanuda (AC: 4)
  - [x] Añadir persistencia del acumulado por `(user_id, task_id)` en `user_task_now_working_time` con `accumulated_s` (segundos)
  - [x] Actualizar endpoints `start/pause` para hacer flush del acumulado y devolver `accumulated_s` + `started_at` + `as_of`
  - [x] Añadir endpoint `POST /api/v1/me/active-task/heartbeat` (cada 60s) para persistir acumulado mientras la tarea siga activa
  - [x] Actualizar UI/cliente para mostrar `elapsed_total_s = accumulated_s + seconds(as_of - started_at)` (no reset)
  - [x] Asegurar flush/cleanup correcto en switch de tarea activa + release/complete

- [x] Task 5: Tests y evidencia (AC: 5)
  - [x] Unit tests i18n (locale parsing + samples)
  - [x] Server tests timer acumulado (pause/resume + heartbeat)
  - [x] Client tests decode/elapsed logic (si aplica)
- [x] Task payload enriched: tests for `task.task_type` + `work_state` + `ongoing_by`
- [ ] Playwright (NO bloqueante): screenshots de hover + focus popover (si está estable; si no, crear follow-up)


## Dev Notes
### i18n (enfoque recomendado)
- Implementar i18n tipado con:
  - `Locale` (Es/En)
  - `Text` (ADT de claves + variantes parametrizadas)
  - `t(locale, text) -> String` con pattern matching
- Organización sugerida:
  - `apps/client/src/scrumbringer_client/i18n/locale.gleam`
  - `apps/client/src/scrumbringer_client/i18n/text.gleam`
  - `apps/client/src/scrumbringer_client/i18n/es.gleam`
  - `apps/client/src/scrumbringer_client/i18n/en.gleam`
  - `apps/client/src/scrumbringer_client/i18n/i18n.gleam`

### Hover popover
- Reusar `.task-card-preview`, pero convertirlo en popover “real” (no debuggy) y accesible:
  - Debe aparecer en `.task-card:hover` y `.task-card:focus-within`.
  - Debe tener `role="tooltip"` (y el trigger debe apuntarlo con `aria-describedby`).
- Delays (decisión cerrada):
  - Hover: `openDelayMs = 350`
  - Focus: `openDelayMs = 0`
  - Cierre: `closeDelayMs = 200`
- UX/estilo (mini-spec):
  - Popover tipo mini-card: fondo, borde, padding y sombra acorde al sistema visual.
  - Flecha discreta conectando popover ↔ card (pseudo-element `::before` o similar) y alineada al anchor.
  - Evitar flicker: mantener abierto si hay hover en card **o** en popover (closeDelayMs).
  - Posicionamiento recomendado: `right-start` con fallbacks `left-start → bottom-start → top-start` (evitar salir de viewport).
  - Layout recomendado para que se vea “pro”:
    - Estructura de contenido en pares Etiqueta/Valor (grid 2 columnas o definition list) con espaciado consistente.
    - `status` como badge (texto + color), evitando que valores cortos se partan en varias líneas.
    - Respetar `prefers-reduced-motion` si hay animación (fade/slide muy sutil).
- Contenido (decisión cerrada: NO traducir valores de DB):
  - Los **labels** se traducen vía i18n (p.ej. `Tipo`, `Creada`, `Estado`).
  - Los **valores provenientes de DB** se muestran tal cual (sin traducción), p.ej. type name `Bug`, status raw `available`.

### Data Model / API Contract (Task Types + work_state)

- **Garantía fuerte: icono siempre disponible para cada Task**
  - Decisión: denormalizar en la API el `task_type` anidado dentro de cada `task`:
    - `task.task_type = { id, name, icon }`
  - Objetivo: que la UI (Pool/tooltip/cards) pueda renderizar iconos **sin consultas adicionales** y sin “missing icon” handling.

- **Contrato API esperado (compat + enriquecido)**
  - Mantener compat: se conservan los campos actuales `task.type_id` y `task.status` sin cambios.
  - Añadir (enriquecido): `task.task_type` con `{id, name, icon}` (siempre presente).
  - Recomendación: si se expone un estado derivado, usar `task.work_state = available|claimed|ongoing|completed` (ver siguiente punto).

- **Modelado de `ongoing` (no es status DB)**
  - Decisión: `ongoing` **NO** es un status persistido en DB.
  - `ongoing` se modela como estado **derivado** de `now_working` (usuario actual trabajando).
  - Invariante: `ongoing` **implica** `claimed` (nunca puede existir ongoing si la tarea no está claimed).
  - Opción A (recomendada por Architect): exponer `work_state` derivado desde backend.
  - Opción B: derivarlo en cliente (pero garantizando la misma semántica e invariante).

- **Refuerzo DB (task_types.icon)**
  - Decisión: reforzar integridad en DB para evitar iconos “vacíos”:
    - `icon NOT NULL`
    - `CHECK (trim(icon) <> '')`
  - Rationale: evita casos de `""` / `"   "` que rompen la promesa de icono “siempre disponible”.

- **Plan de implementación (evitar N+1)**
  - Backend-first:
    - Centralizar el mapping a DTO “Task enriched” (en un único punto).
    - Usar `JOIN task_types` para poblar `task.task_type`.
    - Usar `JOIN/EXISTS` contra `user_now_working` (o equivalente) para computar `work_state` o el flag derivado que corresponda, evitando N+1.
  - Frontend:
    - Consumir `task.task_type.icon` (y opcionalmente `work_state`) para rendering consistente.
    - Mantener fallback temporal a `type_id` solo para compat durante transición (sin bloquear).

- **Riesgos / Compat**
  - Compat: clientes antiguos siguen funcionando con `type_id` + `status`.
  - Riesgo: si hay caching/fixtures/seed data con `icon` vacío, el nuevo CHECK fallará → revisar seeds/migraciones y datos existentes antes de aplicar constraint.
  - Riesgo: derivación `ongoing` debe ser consistente con autorización (solo el usuario autenticado puede ver su propio “now_working” como ongoing).

### UX adicional: Claim por botón + drag-to-claim (follow-up recomendado)
- Contexto del brief (MVP): en tarjetas del Pool, los affordances críticos (acción + drag handle) deben ser siempre visibles y usables.
- Diseño recomendado (para cerrar fricción sin romper accesibilidad):
  - **Botón Claim** (camino universal):
    - Siempre visible en la card (icon-only, estilo secondary por defecto; se enfatiza en hover/focus-within).
    - Siempre accesible por teclado (focus ring + `aria-label`).
  - **Drag-to-claim** (atajo potente, no único camino):
    - Permitir arrastrar una `.task-card` del canvas hacia el panel derecho `Mis tareas` para hacer Claim.
    - El panel `Mis tareas` actúa como dropzone con estados visuales:
      - Drag activo: resaltar borde/fondo + hint “Suelta aquí para coger”.
      - Drag over: estado “ready” con texto “Suelta para Claim”.
      - Drop ok: feedback visual + la tarea desaparece del Pool (ya no es `available`) y aparece en `Mis tareas`.
      - Drop fail: toast y rollback visual si ya no está disponible.
    - Anti-accidentes: el claim ocurre solo al soltar dentro del dropzone.
  - Nota: esta UX de claim por drag es **complementaria** y puede implementarse en story futura si afecta demasiado a DnD/posiciones.

### Now Working timer acumulado
- Contexto:
  - En Story 2.8 el timer se calcula como `as_of - started_at` para la sesión activa.
  - Cambio requerido: el tiempo debe ser **acumulado** por `(user_id, task_id)` y **NO debe reiniciarse** al pausar/reanudar la misma tarea.
- Persistencia (decisión cerrada):
  - Nueva tabla: `user_task_now_working_time` con `accumulated_s` (segundos).
  - Unidad: `s` (segundos). Reset: nunca.
- Eventos que deben “materializar” acumulado:
  - `pause`
  - `switch` (start de otra tarea reemplazando la anterior)
  - `release` / `complete` (si aplica a la tarea activa: flush acumulado → limpiar estado personal → acción)
  - heartbeat periódico cada 60s mientras haya tarea activa
- API / Endpoints (decisión cerrada):
  - Se mantiene `GET /api/v1/me/active-task` y debe devolver además `accumulated_s` (segundos) + `started_at` + `as_of`.
  - Se mantienen `POST /api/v1/me/active-task/start` (body `{ task_id: Int }`) y `POST /api/v1/me/active-task/pause`.
  - Nuevo: `POST /api/v1/me/active-task/heartbeat` (sin body) — el cliente lo llama cada 60s si existe active task.
- Semántica de cálculo en cliente:
  - Cuando hay active task: `elapsed_total_s = accumulated_s + seconds(as_of - started_at)`.
  - Cuando no hay active task: mostrar `accumulated_s` (si se necesita) o 0.

## Testing
- Server: `make test` / `make verify`
- Client: `cd apps/client && gleam test`
- Playwright (NO bloqueante en esta story):
  - Evidencia visual (hover):
    - `test-results/3.0/pool-hover-before.png`
    - `test-results/3.0/pool-hover-after.png`
    - `test-results/3.0/pool-hover-tooltip.png`
    - `test-results/3.0/pool-hover-card.png`
  - Evidencia de layout relacionado (panel derecho):
    - `test-results/3.0/pool-layout-my-tasks.png`
    - `test-results/3.0/pool-layout-full.png`
  - Si Playwright no está estable en otros entornos, no bloquea el cierre (crear follow-up).

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-15 | 0.1 | Draft story for Sprint 3 kickoff | po/dev |
| 2026-01-16 | 0.2 | Implement i18n, popover, and accumulated timer | dev |
| 2026-01-16 | 0.3 | Add optional drag-to-claim dropzone + Playwright evidence | dev |
| 2026-01-16 | 0.4 | Enrich task payload (task_type/work_state) + DB icon check | dev |
| 2026-01-16 | 0.5 | Add task contract tests for task_type/work_state/ongoing_by | dev |
| 2026-01-16 | 0.6 | Add AC5 accumulated timer tests (pause/resume/heartbeat) | dev |

## Dev Agent Record

### Agent Model Used
- OpenAI ChatGPT (coding agent)

### Debug Log References
- `cd apps/client && gleam test`
- `make test`
- `make squirrel`
- `dbmate --url postgres://scrumbringer:scrumbringer@localhost:5432/scrumbringer_test?sslmode=disable migrate`
- `DATABASE_URL=postgres://scrumbringer:scrumbringer@localhost:5432/scrumbringer_test?sslmode=disable cd apps/server && gleam test`
- `make test` (Story 3.0 task contract tests)
- `cd apps/client && gleam test` (Story 3.0 task contract tests)
- `make test` (AC5 accumulated pause/resume/heartbeat tests)
- `cd apps/client && gleam test` (AC5 elapsed total test)
- Playwright (manual evidence): `cd ~/.opencode/skills/playwright-skill && node run.js /tmp/playwright-test-pool-hover.js`
  - Screenshots: `test-results/3.0/pool-hover-before.png`, `test-results/3.0/pool-hover-after.png`, `test-results/3.0/pool-hover-tooltip.png`
- Drag-to-claim smoke check (manual): arrastrar `.task-card` al panel derecho `Mis tareas` hace Claim

### Completion Notes List
- Added typed i18n system (Locale + Text ADT) with ES/EN translations and locale persistence.
- Replaced user-facing UI strings (including a11y labels) with `i18n.t(locale, Text)`.
- Implemented Pool hover/focus tooltip popover with arrow and label i18n (values from DB unchanged).
- Fixed Now Working timer to persist accumulated seconds per `(user_id, task_id)` with heartbeat updates.
- Enriched task payloads with `task.task_type = {id,name,icon}` and `work_state` derived from `status` + `user_now_working` (ongoing ⇒ claimed).
- Updated client rendering to prefer `task.task_type` for icons/names (no catalog lookup for cards/tooltips).
- Added DB constraint to prevent empty task type icons.
- Added server tests to verify task contract fields (`task_type`, `work_state`, `ongoing_by`) on list/get and ongoing state.
- Added accumulated timer tests for pause/resume/heartbeat persistence and client elapsed calculation.

### File List
- `apps/client/src/scrumbringer_client.gleam`
- `apps/client/src/scrumbringer_client/api.gleam`
- `apps/client/src/scrumbringer_client/fetch.ffi.mjs`
- `apps/client/src/scrumbringer_client/styles.gleam`
- `apps/client/src/scrumbringer_client/i18n/locale.gleam`
- `apps/client/src/scrumbringer_client/i18n/text.gleam`
- `apps/client/src/scrumbringer_client/i18n/en.gleam`
- `apps/client/src/scrumbringer_client/i18n/es.gleam`
- `apps/client/src/scrumbringer_client/i18n/i18n.gleam`
- `apps/client/test/i18n_locale_test.gleam`
- `apps/client/test/i18n_smoke_test.gleam`
- `apps/client/test/api_decode_active_task_test.gleam`
- `apps/client/test/api_decode_task_enriched_test.gleam`
- `apps/server/src/scrumbringer_server.gleam`
- `apps/server/src/scrumbringer_server/http/me_active_task.gleam`
- `apps/server/src/scrumbringer_server/http/tasks.gleam`
- `apps/server/src/scrumbringer_server/services/now_working_db.gleam`
- `apps/server/src/scrumbringer_server/services/tasks_db.gleam`
- `apps/server/src/scrumbringer_server/sql/tasks_list.sql`
- `apps/server/src/scrumbringer_server/sql/tasks_get_for_user.sql`
- `apps/server/src/scrumbringer_server/sql/tasks_create.sql`
- `apps/server/src/scrumbringer_server/sql/tasks_claim.sql`
- `apps/server/src/scrumbringer_server/sql/tasks_release.sql`
- `apps/server/src/scrumbringer_server/sql/tasks_complete.sql`
- `apps/server/src/scrumbringer_server/sql/tasks_update.sql`
- `apps/server/src/scrumbringer_server/sql/metrics_project_tasks.sql`
- `apps/server/src/scrumbringer_server/sql.gleam`
- `apps/server/test/tasks_http_test.gleam` (task contract + accumulated timer tests)
- `db/migrations/20260115223000_create_user_task_now_working_time.sql`
- `db/migrations/20260116120000_task_types_icon_non_empty.sql`
- `db/schema.sql`
- `docs/stories/3.0.sprint-3-kickoff-i18n-hover-timer.md`
- `test-results/3.0/pool-hover-before.png`
- `test-results/3.0/pool-hover-after.png`
- `test-results/3.0/pool-hover-card.png`
- `test-results/3.0/pool-hover-tooltip.png`
- `test-results/3.0/pool-layout-my-tasks.png`
- `test-results/3.0/pool-layout-full.png`

## QA Results

### Review Date: 2026-01-16

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
- Solid implementation with typed i18n (`Text` ADT) and consistent use of `i18n.t(locale, ...)` across UI.
- Timer fix is correctly persisted server-side with lifecycle flush + heartbeat.

### Refactoring Performed
- None (review-only).

### Compliance Check
- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ✓
- All ACs Met: ✓ (Playwright evidence is explicitly non-blocking)

### Improvements Checklist
- [x] Verified `cd apps/client && gleam test` passes
- [x] Verified `make test` passes
- [ ] (Nice-to-have) Add Playwright visual evidence for hover + focus popover
- [ ] (Future) Consider splitting `Text` keys by feature to reduce merge risk

### Security Review
- No auth/session changes; no new secret handling.

### Performance Considerations
- Heartbeat every 60s is low overhead; DB writes are bounded per active user/task.

### Files Modified During Review
- None.

### Gate Status

Gate: PASS → docs/qa/gates/3.0-sprint-3-kickoff-i18n-hover-timer.yml
Risk profile: docs/qa/assessments/3.0-risk-20260116.md
NFR assessment: docs/qa/assessments/3.0-nfr-20260116.md

### Recommended Status
✓ Ready for Done
(Story owner decides final status)

### Review Date: 2026-01-16

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
- Implementation aligns with the acceptance criteria for i18n, tooltip accessibility, and accumulated timer behavior.
- Client/server handling for accumulated_s + elapsed_total_s looks consistent with the story contract.

### Refactoring Performed
- None (review-only).

### Compliance Check
- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ⚠️ (missing automated coverage for accumulated timer persistence)
- All ACs Met: ⚠️ (AC5 automated coverage gap)

### Improvements Checklist
- [ ] Add server tests that assert accumulated_s increments on pause/resume and heartbeat updates.
- [ ] Add a client test for elapsed_total_s calculation using accumulated_s + server offset.
- [ ] (Nice-to-have) Add Playwright evidence for hover + focus tooltip states if stable.

### Security Review
- No auth/session changes; CSRF double-submit remains enforced for new endpoints.

### Performance Considerations
- Heartbeat cadence (60s) is low overhead; tooltip rendering adds minimal UI cost.

### Files Modified During Review
- None.

### Gate Status

Gate: CONCERNS → docs/qa/gates/3.0-sprint-3-kickoff-i18n-hover-timer.yml

### Recommended Status
✗ Changes Required - See unchecked items above
(Story owner decides final status)

### Review Date: 2026-01-16

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
- i18n layer is typed and centralized; UI strings and accessibility labels route through `i18n.t` consistently in the sampled views/tests.
- Hover popover meets accessibility contract (`aria-describedby` + `role="tooltip"`) and layout spec (mini-card grid + badge).
- Accumulated timer behavior is persisted server-side with heartbeat and validated by integration-style tests.

### Refactoring Performed
- None (review-only).

### Compliance Check
- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ✓ (unit + server tests cover locale, translations, accumulated timer, heartbeat)
- All ACs Met: ✓ (Playwright visuals remain optional/non-blocking)

### Improvements Checklist
- [x] Verified i18n locale + smoke tests exist (client)
- [x] Verified accumulated timer persistence + heartbeat tests exist (server)
- [ ] (Nice-to-have) Add Playwright focus/hover screenshots if stable in CI
- [ ] (Future) Consider grouping `Text` keys by feature to reduce merge conflicts

### Security Review
- CSRF double-submit enforced on new heartbeat endpoint; no auth regressions observed.

### Performance Considerations
- Heartbeat cadence is bounded (60s) and uses lightweight updates; tooltip rendering is CSS-only.

### Files Modified During Review
- None.

### Gate Status

Gate: PASS → docs/qa/gates/3.0-sprint-3-kickoff-i18n-hover-timer.yml

### Recommended Status
✓ Ready for Done
(Story owner decides final status)
