schema: 1
story: '2.4'
story_title: 'Reset password por link (sin email real)'
gate: CONCERNS
status_reason: 'Flujo principal implementado y tests pasan; faltan controles recomendados (rate limiting) y hay gaps menores de cobertura (password policy server-side + UX manual).'
reviewer: 'Quinn (Test Architect)'
updated: '2026-01-14T14:44:46Z'

top_issues:
  - id: 'SEC-001'
    severity: medium
    finding: 'Los endpoints públicos de reset no tienen rate limiting; además el patrón request→validate puede facilitar enumeración de cuentas.'
    suggested_action: 'Añadir rate limiting por IP (y opcionalmente por email) a /auth/password-resets y /consume; documentar decisión sobre retorno de email en validate.'
    suggested_owner: dev
  - id: 'TEST-001'
    severity: medium
    finding: 'No hay test server-side explícito para password < 12 en /auth/password-resets/consume.'
    suggested_action: 'Añadir test que asegure 422 VALIDATION_ERROR cuando password < 12 (y que no marque token usado).'
    suggested_owner: dev
waiver: { active: false }

quality_score: 80
expires: '2026-01-28T14:44:46Z'

evidence:
  tests_reviewed: 5
  risks_identified: 4
  trace:
    ac_covered: [1, 2, 3, 4, 5, 6, 7, 8]
    ac_gaps: [9, 10, 11]

nfr_validation:
  _assessed: [security, performance, reliability, maintainability]
  security:
    status: CONCERNS
    notes: 'Sin rate limiting en endpoints públicos; posible enumeración vía request→validate.'
  performance:
    status: PASS
    notes: 'Consultas simples e indexadas; transacción corta para consume.'
  reliability:
    status: PASS
    notes: 'Single-use + TTL + invalidation; consume transaccional y códigos estables.'
  maintainability:
    status: PASS
    notes: 'Separación clara (HTTP → service) y tests focalizados para paths principales.'

trace_refs:
  risk_profile: 'docs/qa/assessments/2.4-risk-20260114.md'
  nfr_assessment: 'docs/qa/assessments/2.4-nfr-20260114.md'
  trace_matrix: 'docs/qa/assessments/2.4-trace-20260114.md'
