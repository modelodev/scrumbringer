schema: 1
story: '2.5'
story_title: 'Theme engine v1 (tokens + CSS vars + persistencia)'
gate: CONCERNS
status_reason: 'Implementación y tests unitarios OK, pero faltan validaciones manuales de contraste/estados y hay riesgo de flash pre-mount en tema persistido.'
reviewer: 'Quinn (Test Architect)'
updated: '2026-01-14T15:22:53Z'

top_issues:
  - id: 'UX-001'
    severity: medium
    finding: 'Checklist visual (AC13) aún no verificado en default+dark (contraste, focus ring, hover/disabled, modales/overlay).'
    suggested_action: 'Completar el checklist visual manual y ajustar tokens/estilos si aparece algún P0 (especialmente links y focus ring).'
    suggested_owner: 'dev'
  - id: 'UX-002'
    severity: medium
    finding: 'Posible “flash” perceptible antes de que Lustre aplique el tema persistido (AC12), dependiendo del navegador/red.'
    suggested_action: 'Si se observa flash, aplicar el tema antes del mount (p.ej. inline pre-hydration o early CSS injection) manteniendo tokens en CSS vars.'
    suggested_owner: 'dev'

waiver: { active: false }

quality_score: 80
expires: '2026-01-28T15:22:53Z'

evidence:
  tests_reviewed: 1
  risks_identified: 3
  trace:
    ac_covered: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    ac_gaps: [11, 12, 13]

nfr_validation:
  _assessed: [security, performance, reliability, maintainability]
  security:
    status: PASS
    notes: 'Sin cambios de auth/API; persistencia client-only. Inyección de CSS es constante (no derivada de input).'
  performance:
    status: PASS
    notes: 'Cambio de tema es actualización local (CSS vars) sin network; impacto mínimo.'
  reliability:
    status: PASS
    notes: 'Fallback a default si storage inválido; UI no depende de servidor.'
  maintainability:
    status: CONCERNS
    notes: 'CSS global en string es un MVP aceptable, pero conviene mantener el set de tokens pequeño y revisar que no se reintroduzcan colores hardcodeados.'

trace_refs:
  risk_profile: 'docs/qa/assessments/2.5-risk-20260114.md'
  nfr_assessment: 'docs/qa/assessments/2.5-nfr-20260114.md'
  trace_matrix: 'docs/qa/assessments/2.5-trace-20260114.md'
