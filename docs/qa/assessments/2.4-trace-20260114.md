# Requirements Traceability Matrix

## Story: 2.4 - Reset password por link (sin email real)

### Coverage Summary

- Total ACs: 11
- Fully Covered: 11 (100%)
- Partially Covered: 0
- Not Covered: 0

### Requirement Mappings

#### AC1: Request reset token (public)

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::request_reset_does_not_leak_unknown_email_test`

#### AC2: Single active token per email

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::request_reset_invalidates_previous_active_token_test`

#### AC3: Tokens are single-use

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::reset_token_is_single_use_test`

#### AC4: Validate reset token (public)

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::request_reset_does_not_leak_unknown_email_test`

#### AC5: Consume reset token (public)

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::reset_token_is_single_use_test`

#### AC6: Unknown email does not leak

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::request_reset_does_not_leak_unknown_email_test`

#### AC7: Token TTL (24h)

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::validate_rejects_expired_tokens_test`

#### AC8: Error codes are consistent

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam` (asserts `RESET_TOKEN_INVALID` / `RESET_TOKEN_USED`)

#### AC9: Password policy (minimum 12)

- **Integration Test**: `apps/server/test/password_resets_http_test.gleam::consume_rejects_short_password_and_keeps_token_active_test`
- **Unit Test (client state machine)**: `apps/client/test/reset_password_test.gleam`

#### AC10: Client UX

- **Unit Test (client state machine)**: `apps/client/test/reset_password_test.gleam`
- **UI behavior (manual)**: Login has “Forgot password?” toggle + copy link; `/reset-password?token=...` validates and consumes.

#### AC11: No SMTP/email integration

- **Code inspection**: Server returns `url_path` only; no mailer integration.

Trace matrix: docs/qa/assessments/2.4-trace-20260114.md
