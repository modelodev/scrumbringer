# Risk Profile: Story 2.4

Date: 2026-01-14
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 4
- Critical Risks: 0
- High Risks: 0
- Medium Risks: 2
- Low Risks: 2

## Risk Matrix

| Risk ID | Description | Probability | Impact | Score | Priority |
|---|---|---|---|---|---|
| SEC-001 | Account enumeration via reset token validation | Medium (2) | Medium (2) | 4 | Medium |
| SEC-002 | Abuse/spam of password reset endpoints (no rate limiting) | Medium (2) | Medium (2) | 4 | Medium |
| DATA-001 | Token reuse / multiple active tokens per email | Low (1) | High (3) | 3 | Low |
| OPS-001 | User confusion: link always returned even for unknown email | Medium (2) | Low (1) | 2 | Low |

## Mitigations & Evidence

- **SEC-001**: Token validation is token-based only, but because `POST /auth/password-resets` returns a token, a client can still distinguish valid vs invalid via `GET /auth/password-resets/:token`. Mitigation recommendation: add rate limiting to reset endpoints and consider returning a non-identifying payload on validation (PO decision; may affect AC4).
- **SEC-002**: No rate limiting on password reset endpoints. Recommendation: add IP-based rate limiting (and optionally email-based throttling).
- **DATA-001**: DB enforces single active token per email via partial unique index; tokens are marked used on success; previous tokens invalidated on regeneration.
- **OPS-001**: Intended MVP trade-off (“no SMTP”); UI communicates that link is generated for copy/paste.

Risk profile: docs/qa/assessments/2.4-risk-20260114.md
