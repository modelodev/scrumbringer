# 2.7 Browser Smoke (Manual)

Date: 2026-01-15

Goal: Provide evidence for browser-level behavior in Story 2.7 (AC1/AC4/AC5).

## Preconditions

- Caddy running with correct `SB_PORT` export.
- App served from: `https://localhost:8443`
- Backend reachable via `/api/v1/*` (health check OK).

## Scenarios

### 1) Deep link + refresh (F5)

- [x] Navigate directly to: `https://localhost:8443/admin/members?project=2`
- [x] Press F5 (or Cmd+R).
- [x] Expected: app stays on Admin → Members, and project selector remains at project 2.

Evidence (Playwright screenshots):
- `/tmp/2.7-1-admin-members-initial.png`
- `/tmp/2.7-1-admin-members-after-reload.png`

### 2) History API: pushState vs replaceState

- [x] From admin members, click to another section (user-initiated navigation).
- [x] Expected: URL changes via pushState (Back should return).
- [x] Enter an invalid project id (e.g. `project=nope`) if supported.
- [x] Expected: URL normalizes via replaceState (Back should not loop invalid state).

Evidence (Playwright screenshots):
- `/tmp/2.7-3-admin-members.png` (precondition: on members)
- `/tmp/2.7-3-admin-projects.png` (pushState navigation)
- `/tmp/2.7-2-admin-projects-before-invalid.png`
- `/tmp/2.7-2-admin-members-invalid-entered.png` (normalized to `project=2`)
- `/tmp/2.7-2-back-to-admin-projects.png`
### 3) Back/Forward (`popstate`)

- [x] Click through: `/admin/projects` → `/admin/members` → `/app/my-bar`
- [x] Use browser Back twice, then Forward once.
- [x] Expected: view updates correctly and hydration runs without redirect loops.

Evidence (Playwright screenshots):
- `/tmp/2.7-3-admin-projects.png`
- `/tmp/2.7-3-admin-members.png`
- `/tmp/2.7-3-member-my-bar.png`
- `/tmp/2.7-3-back-to-admin-members.png`
- `/tmp/2.7-3-back-to-admin-projects.png`
- `/tmp/2.7-3-forward-to-admin-members.png`

## Result

- Scenario 1: PASS (Playwright evidence)
- Scenario 2: PASS (Playwright evidence)
- Scenario 3: PASS (Playwright evidence)

## Notes

- If any scenario fails, note the URL and what you observed (e.g., redirected to Login, wrong section, infinite reload, etc.).