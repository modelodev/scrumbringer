# Risk Profile: Story 2.1

Date: 2026-01-14
Reviewer: Quinn (Test Architect)

## Executive Summary

This story adds a new onboarding primitive (email-bound invite links). The main risks are security abuse (unauthorized creation) and operational correctness (single active token per email + consistent invalidation).

## Risk Matrix

| Risk ID  | Category     | Description | Probability | Impact | Score | Priority |
|---------|--------------|-------------|------------:|-------:|------:|----------|
| SEC-001 | Security      | Non-admin or CSRF-less requests could create invite links | Low (1) | High (3) | 3 | Low |
| DATA-001| Data Integrity | Multiple active tokens per email could allow ambiguous onboarding | Low (1) | Medium (2) | 2 | Low |
| OPS-001 | Operational   | Local/CI migration + DB target confusion could cause flaky runs | Medium (2) | Medium (2) | 4 | Medium |

## Evidence

- Authz + CSRF enforced for POSTs in `apps/server/src/scrumbringer_server/http/org_invite_links.gleam`.
- Single active token per email enforced via partial unique index in `db/migrations/20260114100000_create_org_invite_links.sql`.
- Invalidation behavior validated in `apps/server/test/org_invite_links_http_test.gleam`.

## Recommendations

### Must Fix

- None.

### Monitor / Follow-up

- Consider keeping `make` defaults aligned with a dedicated test database (or document the expectation) to reduce environment confusion (`Makefile`).
- Consider rate limiting / audit logging for invite link creation in later stories if exposed to untrusted admins or broader roles.
