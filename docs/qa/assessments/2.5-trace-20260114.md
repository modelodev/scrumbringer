# Requirements Traceability Matrix

## Story: 2.5 - Theme engine v1 (tokens + CSS vars + persistencia)

### Coverage Summary

- Total ACs: 13
- Fully Covered: 10 (77%)
- Partially Covered: 3
- Not Covered: 0

### Requirement Mappings

#### AC1: Tokens semánticos definidos

- **Code inspection**: `apps/client/src/scrumbringer_client/theme.gleam::tokens`

#### AC2: CSS variables como fuente de verdad

- **Code inspection**: `apps/client/src/scrumbringer_client.gleam::view` sets CSS vars on root container; `apps/client/src/scrumbringer_client/theme.gleam::base_css` consumes `var(--sb-*)` only.

#### AC3: Dos temas completos (default + dark)

- **Unit Test**: `apps/client/test/theme_test.gleam::{tokens_default_complete_test,tokens_dark_complete_test}`

#### AC4: Default + fallback predecible

- **Unit Test**: `apps/client/test/theme_test.gleam::deserialize_invalid_falls_back_to_default_test`

#### AC5: Persistencia client-only (`sb_theme`)

- **Code inspection**: `apps/client/src/scrumbringer_client/theme.gleam::{load_from_storage,save_to_storage}` + `apps/client/src/scrumbringer_client/fetch.ffi.mjs::{local_storage_get,local_storage_set}`

#### AC6: Efecto global (admin + member)

- **Code inspection**: `apps/client/src/scrumbringer_client/theme.gleam::base_css` styles shared primitives; no server dependency.

#### AC7: UI de switch discoverable y accesible

- **Code inspection**: `apps/client/src/scrumbringer_client.gleam::view_theme_switch` (label + select; keyboard operable).

#### AC8: Sin acoplar CSS a lógica

- **Code inspection**: No per-component branching by theme; switching only changes vars.

#### AC9: Contrato mínimo de tokens

- **Code inspection**: `apps/client/src/scrumbringer_client/theme.gleam::tokens` defines the full required set.

#### AC10: Estados interactivos coherentes

- **Code inspection**: `apps/client/src/scrumbringer_client/theme.gleam::base_css` defines hover/focus/disabled for buttons and links.

#### AC11: Accesibilidad básica (contraste)

- **Manual**: Requires spot-check in both themes (text/link contrast on bg/surface/elevated; focus ring visibility).

#### AC12: Sin parpadeos perceptibles (no flash)

- **Manual/Environmental**: Depends on browser paint timing; verify no visible flash on reload with `sb_theme=dark`.

#### AC13: Validación visual mínima (manual)

- **Manual**: Execute checklist in story across login/header/tables/buttons/links/messages/modals.

Trace matrix: docs/qa/assessments/2.5-trace-20260114.md
