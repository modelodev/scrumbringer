# NFR Assessment: 2.1

Date: 2026-01-14
Reviewer: Quinn (Test Architect)

## Summary

- Security: PASS — org-admin authz + CSRF double-submit enforced for POSTs; token is high-entropy and opaque.
- Performance: PASS — simple indexed queries; no heavy joins; list is org-scoped and sorted.
- Reliability: PASS — invalidation + insertion performed atomically via a single SQL statement; deterministic error handling.
- Maintainability: PASS — `Makefile` clarifies DB expectations and uses `dbmate migrate` (no implicit DB creation).

## Notes

### Security

- CSRF enforced for `POST /api/v1/org/invite-links` and `POST /api/v1/org/invite-links/regenerate`.
- Email normalization ensures uniqueness rules apply consistently.
- No rate limiting (acceptable for MVP, but consider later if exposed).

### Performance

- `org_invite_links` has indexes on `(org_id)`, `(email)` and a partial unique index for active tokens.

### Reliability

- Single statement invalidation + insert avoids race windows.

### Maintainability

- `Makefile` now documents that CI should override `DATABASE_URL` and uses `dbmate migrate` (no DB creation side effects).

Gate NFR block ready → paste into `docs/qa/gates/2.1-invites-by-link.yml` under `nfr_validation`
